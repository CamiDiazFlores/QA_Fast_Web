# Configuraci√≥n
url = "{url}"
email = "{email}"
navigate_url = "{navigate_url}"

print("=" * 80)
print("üöÄ INICIO: LOGIN CON GOOGLE AUTH")
print("=" * 80)

# PASO 1: Navegaci√≥n
print("\nüìç PASO 1: Navegando a la URL de login")
driver.get(url)
time.sleep(3)
driver.execute_script("document.body.style.border='5px solid purple';")
print(f"‚úÖ P√°gina cargada: {driver.title}")
save_screenshot()
time.sleep(2)

# PASO 2: Buscar bot√≥n de Google Auth
print("\nüìç PASO 2: Buscando bot√≥n 'Continuar con Google'")
try:
    google_auth_button = WebDriverWait(driver, 10).until(
        EC.element_to_be_clickable((By.XPATH, "//button[contains(text(), 'Continuar con Google') or contains(@aria-label, 'Google')]"))
    )
    driver.execute_script("arguments[0].style.border='3px solid blue'; arguments[0].scrollIntoView({block: 'center'});", google_auth_button)
    time.sleep(1)
    google_auth_button.click()
    print("‚úÖ Bot√≥n 'Continuar con Google' clickeado")
    time.sleep(5)
except Exception as e:
    print(f"‚ùå Error al buscar o clicar el bot√≥n de Google Auth: {e}")
    save_screenshot()

# PASO 3: Redirecci√≥n a t√©rminos y condiciones
print("\nüìç PASO 3: Validando redirecci√≥n a t√©rminos y condiciones")
time.sleep(3)
current_url = driver.current_url
if "terminos" in current_url.lower():
    print("‚úÖ Redirigido a la pantalla de t√©rminos y condiciones")
    try:
        accept_terms_button = WebDriverWait(driver, 10).until(
            EC.element_to_be_clickable((By.XPATH, "//button[contains(text(), 'Aceptar') or contains(text(), 'Continuar')]")
        )
        driver.execute_script("arguments[0].style.border='3px solid green'; arguments[0].scrollIntoView({block: 'center'});", accept_terms_button)
        time.sleep(1)
        accept_terms_button.click()
        print("‚úÖ T√©rminos aceptados")
        time.sleep(5)
    except Exception as e:
        print(f"‚ùå Error al aceptar t√©rminos: {e}")
        save_screenshot()
else:
    print("‚ùå No se redirigi√≥ a la pantalla de t√©rminos y condiciones")
    save_screenshot()

# PASO 4: Validaci√≥n de redirecci√≥n final
print("\nüìç PASO 4: Validando redirecci√≥n final a la p√°gina de inicio")
time.sleep(3)
current_url = driver.current_url
if navigate_url in current_url:
    print("‚úÖ Redirigido correctamente a la p√°gina de inicio")
    driver.execute_script("""
        var div = document.createElement('div');
        div.innerHTML = '‚úÖ LOGIN EXITOSO';
        div.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:green;color:white;padding:60px;font-size:32px;z-index:10000;border-radius:20px;';
        document.body.appendChild(div);
    """)
    save_screenshot()
    time.sleep(3)
else:
    print("‚ùå Redirecci√≥n final fallida")
    save_screenshot()

print("\nüèÅ FIN DEL TEST")
print("=" * 80)
